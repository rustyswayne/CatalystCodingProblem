var Peeps=function(){function e(){$(document).ready(function(){Peeps.Dashboards.init()})}function n(){return!1}function t(e,n){try{var t=_.find(c,function(n){return n.event===e});if(void 0!==t&&null!==t)void 0!==n&&"function"==typeof n&&t.callbacks.push(n);else{var a=[];void 0!==n&&"function"==typeof n&&a.push(n),c.push({event:e,callbacks:a})}}catch(e){console.info(e)}}function a(e,n){var t=_.find(c,function(n){return n.event===e});void 0!==t&&null!==t&&_.each(t.callbacks,function(t){try{t(e,n)}catch(t){MUI.Logger.captureError(t,{extra:{eventName:e,args:n}})}})}function i(e){var n={};return function(t,a){return n[t]||(n[t]=$.Deferred(function(n){e(n,t)}).promise()),n[t].done(a)}}function o(e,n){var t=_.find(e,function(e){return e.alias===n});return void 0===t?"":t.name}function r(e){d.events&&_.each(e,function(e){MUI.on(e.name,function(n,t){console.log(e),console.log(void 0===t?"No args":t)})})}function s(e){d.console&&console.log(e)}var d={events:!1,console:!0},c=[];return{Settings:{Notifications:{},Endpoints:{}},Services:{},init:e,hasLogger:n,createCache:i,on:t,emit:a,getEventNameByAlias:o,debugConsoleEvents:r,debugConsole:s}}();Peeps.Settings={spinnerSvg:"/Media/Placeholders/balls.svg",enableApiDelays:!0,apiRoutes:[{id:"countrymetrics",value:"/dashboard/countriessnapshot",title:"Querying Country Metrics...",notes:"",delay:750},{id:"peopleprops",value:"/dashboard/peoplepropertystats",title:"Evaluating Profiles...",notes:"",delay:1250},{id:"randomtweet",value:"/dashboard/randomlasttweet",title:"Checking Twitter...",notes:"",delay:0}]},Peeps.Dashboards={init:function(){var e=$("div[data-dashboard]");e.length&&_.each(e,function(e){Peeps.Dashboards.binder.invoke(e)})},binder:{invoke:function(e){var n=$(e).data("dashboard"),t=Peeps.Dashboards.spinner.makeId();Peeps.Dashboards.spinner.appendSpinner(e,t);var a={dashboard:e,args:{},skip:!0};if("donothing"!==n){var i=_.find(Peeps.Settings.apiRoutes,function(e){if(e.id===n)return e});void 0!==i&&(a.args=i,a.skip=!1,Peeps.Dashboards.binder.query(a))}},query:function(e){if(void 0===e)throw new Error("Routing params have not been defined.");var n=e.dashboard;$(n).find(".chart-title").text(e.args.title);var t=void 0===e.args.delay?0:e.args.delay;Peeps.Settings.enableApiDelays||(t=0),t>0&&$(n).find(".chart-notes").text("FAKE DELAY of ("+e.args.delay+" ms) added for demo!"),$(n).find(""),$.ajax({url:e.args.value,dataType:"html"}).done(function(e){setTimeout(function(){$(n).parent().html(e),$(n).find(".chart-notes").text("Note:")},t)}).fail(function(){console.log("Failure not implemented.")})}},spinner:{activeIds:[],appendSpinner:function(e,n){Peeps.Dashboards.spinner.activeIds.push(n);var t=Peeps.Dashboards.spinner.build(n);$(e).find(".chart-stage").html(t)},build:function(e){return $('<div class="dashboard-spinner"><img src="'+Peeps.Settings.spinnerSvg+'" id="'+e+'" alt="Loading..." /></div>')},makeId:function(){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=0;t<10;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}}},Peeps.init();